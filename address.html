<!DOCTYPE html>
<html>
<head>
		<title>Address Validation</title>
</head>

<body>
	<form id="input" class="form" method="get">	
		<span>Enter address here:</span><br/>
		<input type="text" name="street" id="street" placeholder="Address1*"/><br/>
		<input type="text" name="street2" id="street2" placeholder="Address2"/><br/>
		<input type="text" name="city" id="city" placeholder="City*"/><br/>
		<input type="text" name="state" id="state" placeholder="State*"/><br/>
		<input type="tel" name="zip" id="zip" placeholder="Postal Code"/><br/>
		<button type="button" id="submit">Submit</button>
		<button type="reset" id="reset")>Reset</button>
	</form>
	<p id="error"></p>
	<div id="result" class="form">
			<br><span>Your address:</span><br/>
			<output type="text" name="street" id="streetOut" placeholder="Street Address"><br/>
			<output type="text" name="street2" id="street2Out" placeholder="Street Address 2"><br/>
			<output type="text" name="city" id="cityOut" placeholder="City"><br/>
			<output type="text" name="state" id="stateOut" placeholder="State"><br/>
			<output type="tel" name="zip" id="zipOut" placeholder="Postal Code"><br/>		
	</div>
	<p id="message"></p>
	<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
	<script type = "text/javascript">

		document.getElementById("submit").onclick = validate;
		document.getElementById("reset").onclick = clearError;
		function validate() {
			var street = document.getElementById("street").value;
			var street2 = document.getElementById("street2").value;
			var zip = document.getElementById("zip").value;
			var city = document.getElementById("city").value;	
			var state = document.getElementById("state").value;
			document.getElementById("error").innerHTML = "Submitted.";
			if(street == null || street == ""){
				document.getElementById("error").innerHTML = "Address 1 is required.";
				return false;
			}else if(city == null || city == ""){
				document.getElementById("error").innerHTML = "City is required.";
				return false;
			}else if(state == null || state == ""){
				document.getElementById("error").innerHTML = "State is required.";
				return false;
			}else {
				readXml("https://trial.serviceobjects.com/av3/api.svc/GetBestMatches?BusinessName=&Address="+street+"&Address2="+street2+"&City="+city+"&State="+state+"&PostalCode="+zip+"&LicenseKey=WS72-GUL2-YQM1");
				//readXml("xmlFile.xml");
			}
		}
		
		function readXml(url){
			var xmlDoc;

			if(typeof window.DOMParser != "undefined") {
				xmlhttp=new XMLHttpRequest();
				xmlhttp.open("GET",url,false);
				if (xmlhttp.overrideMimeType){
					xmlhttp.overrideMimeType('text/xml');
				}
				xmlhttp.send();
				xmlDoc=xmlhttp.responseXML;
				var isValid =xmlDoc.getElementsByTagName("IsCASS")[0].childNodes[0];
				if(isValid.nodeValue == 'true'){
					//var tagObj=xmlDoc.getElementsByTagName("Address");
					//for(i=0; i < tagObj.length; i++){
						xmlDoc=xmlhttp.responseXML;
						var tagObj=xmlDoc.getElementsByTagName("Address");
						var streetOut = xmlDoc.getElementsByTagName("Address1")[0].childNodes[0];
						//var street2Out = tagObj[i].getElementsByTagName("Address2")[0].childNodes[0];
						var cityOut = xmlDoc.getElementsByTagName("City")[0].childNodes[0];
						var stateOut = xmlDoc.getElementsByTagName("State")[0].childNodes[0];
						var zipOut = xmlDoc.getElementsByTagName("Zip")[0].childNodes[0];
					
					document.getElementById("streetOut").innerHTML = streetOut.nodeValue;
					//document.getElementById("street2Out").innerHTML = street2Out.nodeValue;	
					document.getElementById("cityOut").innerHTML = cityOut.nodeValue;
					document.getElementById("stateOut").innerHTML = stateOut.nodeValue;	
					document.getElementById("zipOut").innerHTML = zipOut.nodeValue;
				} else {
					document.getElementById("streetOut").innerHTML = "Invalid address";
				}
			}
			else{
				xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
				xmlDoc.async="false";
				xmlDoc.load(xmlFile);
			}
		}

		
		function clearError(){
			document.getElementById("error").innerHTML = "";
		}
	</script>

</body>
</html>

